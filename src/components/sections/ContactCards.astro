---
import Badge from "../Badge.astro";
import SectionLayout from "../../layouts/SectionLayout.astro";
import AlignmentLayout from "../../layouts/AlignmentLayout.astro";
import Title from "../Title.astro";
import Description from "../Description.astro";

// Placeholder images - using the same as MostTrusted for now as requested "logic of wallpaper"
// Ideally these should be specific to this section, but we use these as fallback/placeholders
import BackgroundImage from "../../assets/details/team-background.png";
import BackgroundImageMobile from "../../assets/details/team-background-mobile.png";
import { cn } from "../../utils/cn";
import { Image } from "astro:assets";
import StartsIcon from "../../assets/icons/stars-light-sparkle.svg";
import PulseGlow from "../effects/PulseGlow.astro";

// Classes organizadas por categoria para melhor legibilidade
const sectionOuterClasses = cn(
  // Layout
  "flex items-center w-full relative",
);

const sectionInnerClasses = cn(
  // Layout & Sizing
  "w-full h-fit py-[88px]",
);

const mainLayoutClasses = cn(
  // Spacing & Layout
  "gap-[80px] h-[-webkit-fill-available] relative z-10",
);

const contentSectionClasses = cn(
  // Spacing
  "gap-4",
  // Padding
  "p-4",
);

const heroTitleClasses = cn(
  // Typography
  "text-center",
);

const cardSectionClasses = cn(
  // Spacing
  "gap-8 max-sm:gap-2",
  // Layout
  "flex items-center w-full relative",
  // Responsividade
  "max-sm:flex-col",
);

const cardContentSectionClasses = cn(
  // Colors & Styles
  "bg-white/10 backdrop-blur-[80px] max-h-[518px] rounded-[8px]",
  // Sizing
  "w-full max-w-[384px]", // Assuming 3 cards fitting in width
);
---

<SectionLayout
  outerClassName={sectionOuterClasses}
  innerClassName={sectionInnerClasses}
  autoMargin={true}
>
  <div
    class="contact-cards-background absolute inset-0 -z-10 bg-cover bg-center bg-no-repeat"
  >
  </div>
  <PulseGlow bottom={true} className="-z-10" />

  <AlignmentLayout
    direction="vertical"
    justify="center"
    align="center"
    className={mainLayoutClasses}
  >
    <AlignmentLayout
      direction="vertical"
      justify="center"
      align="center"
      className="w-full max-w-[656px]"
      style="gap: 1.5rem;"
    >
      <Badge text="Contact our team">
        <Image
          src={StartsIcon}
          alt="Arrow"
          class="w-full h-full object-contain"
        />
      </Badge>

      <AlignmentLayout
        direction="vertical"
        justify="center"
        align="center"
        className="gap-2"
      >
        <Title
          text="Meet the leadership</br>of our team"
          className={heroTitleClasses}
        />
        <Description
          text="Always aiming for transparency, we make our entire team available to you."
          className="max-w-[588px] text-center"
        />
      </AlignmentLayout>
    </AlignmentLayout>

    <AlignmentLayout
      direction="horizontal"
      justify="center"
      align="center"
      className={cardSectionClasses}
    >
      <AlignmentLayout
        direction="vertical"
        justify="center"
        align="center"
        className={cardContentSectionClasses}
      >
        <div class="w-full h-[316px] bg-white/5 rounded-t-[8px]"></div>

        <AlignmentLayout
          direction="vertical"
          justify="start"
          align="start"
          className={contentSectionClasses}
        >
          <AlignmentLayout
            direction="vertical"
            justify="start"
            align="start"
            className="gap-1"
          >
            <Title text="Customer Support" variant="secondary" />
            <Description
              text="Need help with your account or transactions? Our support team is ready to assist you."
              className="uppercase"
              variant="secondary"
            />
          </AlignmentLayout>

          <Description
            text="Need help with your account or transactions? Our support team is ready to assist you."
            variant="secondary"
          />
        </AlignmentLayout>
      </AlignmentLayout>

      <AlignmentLayout
        direction="vertical"
        justify="center"
        align="center"
        className={cardContentSectionClasses}
      >
        <div class="w-full h-[316px] bg-white/5 rounded-t-[8px]"></div>

        <AlignmentLayout
          direction="vertical"
          justify="start"
          align="start"
          className={contentSectionClasses}
        >
          <AlignmentLayout
            direction="vertical"
            justify="start"
            align="start"
            className="gap-1"
          >
            <Title text="Customer Support" variant="secondary" />
            <Description
              text="Need help with your account or transactions? Our support team is ready to assist you."
              className="uppercase"
              variant="secondary"
            />
          </AlignmentLayout>

          <Description
            text="Need help with your account or transactions? Our support team is ready to assist you."
            variant="secondary"
          />
        </AlignmentLayout>
      </AlignmentLayout><AlignmentLayout
        direction="vertical"
        justify="center"
        align="center"
        className={cardContentSectionClasses}
      >
        <div class="w-full h-[316px] bg-white/5 rounded-t-[8px]"></div>

        <AlignmentLayout
          direction="vertical"
          justify="start"
          align="start"
          className={contentSectionClasses}
        >
          <AlignmentLayout
            direction="vertical"
            justify="start"
            align="start"
            className="gap-1"
          >
            <Title text="Customer Support" variant="secondary" />
            <Description
              text="Need help with your account or transactions? Our support team is ready to assist you."
              className="uppercase"
              variant="secondary"
            />
          </AlignmentLayout>

          <Description
            text="Need help with your account or transactions? Our support team is ready to assist you."
            variant="secondary"
          />
        </AlignmentLayout>
      </AlignmentLayout>
    </AlignmentLayout>
  </AlignmentLayout>
</SectionLayout>

<script
  define:vars={{
    bgDesktop: BackgroundImage.src,
    bgMobile: BackgroundImageMobile.src,
  }}
>
  (function () {
    "use strict";
    const contactBackground = document.querySelector(
      ".contact-cards-background",
    );
    if (!contactBackground) return;

    function updateBackgroundImage() {
      const isMobile = window.innerWidth < 640;
      contactBackground.style.backgroundImage = `url('${isMobile ? bgMobile : bgDesktop}')`;
    }

    // Atualizar na inicialização
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", updateBackgroundImage, {
        once: true,
      });
    } else {
      updateBackgroundImage();
    }

    // Handle window resize com debounce
    let resizeTimeout;
    const handleResize = () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(updateBackgroundImage, 250);
    };
    window.addEventListener("resize", handleResize, { passive: true });
  })();
</script>
