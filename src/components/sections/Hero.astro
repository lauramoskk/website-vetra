---
import Button from "../Button.astro";
import SectionLayout from "../../layouts/SectionLayout.astro";
import AlignmentLayout from "../../layouts/AlignmentLayout.astro";
import Description from "../Description.astro";

import BackgroundImage from "../../assets/details/background.png";
import BackgroundImageMobile from "../../assets/details/background-mobile.png";
import Image from "astro/components/Image.astro";
import { cn } from "../../utils/cn";

// Classes organizadas por categoria para melhor legibilidade
const sectionOuterClasses = cn(
	// Layout
	"flex items-center w-full",
	// Identificador para estilos específicos
	"hero-section",
);

const sectionInnerClasses = cn(
	// Layout & Sizing
	"w-full h-[880px] max-w-[1370px] relative",
	// Visual
	"rounded-b-2xl bg-white/[0.04] bg-cover bg-center bg-no-repeat",
	// Responsividade
	"max-sm:h-[907px] max-sm:mx-2",
);

const mainLayoutClasses = cn(
	// Spacing & Layout
	"gap-[60px] h-[-webkit-fill-available] relative z-10",
	// Responsividade
	"max-sm:mx-4",
);

const heroImage1Classes = cn(
	// Position
	"absolute top-[161px] left-[78px]",
	// Sizing
	"w-[240px] h-[320px]",
	// Visual
	"bg-white/[0.04] rounded-lg",
	// Responsividade
	"max-sm:hidden",
);

const heroImage2Classes = cn(
	// Position
	"absolute bottom-[83px] right-[77px]",
	// Sizing
	"w-[240px] h-[320px]",
	// Visual
	"bg-white/[0.04] rounded-lg",
	// Responsividade
	"max-sm:hidden",
);

const imageClasses = cn(
	// Sizing & Object
	"w-full h-full object-cover rounded-lg",
);

const contentSectionClasses = cn(
	// Spacing
	"gap-[22px]",
);

const heroTitleClasses = cn(
	// Typography
	"font-serif text-[56px] leading-[64px] font-bold text-center text-white",
	// Sizing
	"max-w-[788px]",
	// Responsividade
	"max-sm:text-[40px] max-sm:leading-[48px]",
);

const buttonsContainerClasses = cn(
	// Spacing
	"gap-4",
	// Responsividade
	"max-sm:flex-col max-sm:w-full max-sm:gap-2",
);
---

<SectionLayout
	outerClassName={sectionOuterClasses}
	innerClassName={sectionInnerClasses}
>
	<div class="hero-background absolute inset-0 rounded-b-2xl -z-10"></div>
	<AlignmentLayout
		direction="vertical"
		justify="center"
		align="center"
		className={mainLayoutClasses}
	>
		<AlignmentLayout
			direction="vertical"
			justify="center"
			align="center"
			className={contentSectionClasses}
		>
			<h1 class={heroTitleClasses}>
				Título Principal da <span class="text-text-blue">Landing Page</span>
			</h1>
			<Description
				text="Subtítulo descritivo explicando a proposta de valor do produto ou serviço de forma clara e objetiva para o visitante."
				className="max-w-[588px] text-center"
			/>
		</AlignmentLayout>

		<AlignmentLayout
			direction="horizontal"
			justify="center"
			align="center"
			className={buttonsContainerClasses}
		>
			<a href="#contato" class="max-sm:w-full">
				<Button
					text="Call to Action Principal"
					variant="primary"
					className="max-sm:w-full"
				/>
			</a>
			<a href="#sobre" class="max-sm:w-full">
				<Button
					text="Call to Action Secundário"
					variant="outline"
					className="max-sm:w-full"
				/>
			</a>
		</AlignmentLayout>
	</AlignmentLayout>
</SectionLayout>

<script
	define:vars={{
		bgDesktop: BackgroundImage.src,
		bgMobile: BackgroundImageMobile.src,
	}}
>
	(function () {
		"use strict";
		const heroBackground = document.querySelector(".hero-background");
		if (!heroBackground) return;

		function updateBackgroundImage() {
			const isMobile = window.innerWidth < 640;
			heroBackground.style.backgroundImage = `url('${isMobile ? bgMobile : bgDesktop}')`;
		}

		// Atualizar na inicialização
		if (document.readyState === "loading") {
			document.addEventListener("DOMContentLoaded", updateBackgroundImage, {
				once: true,
			});
		} else {
			updateBackgroundImage();
		}

		// Handle window resize com debounce
		let resizeTimeout;
		const handleResize = () => {
			clearTimeout(resizeTimeout);
			resizeTimeout = setTimeout(updateBackgroundImage, 250);
		};
		window.addEventListener("resize", handleResize, { passive: true });
	})();
</script>
